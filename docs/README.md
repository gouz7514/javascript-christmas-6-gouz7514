# 테크 스펙
## 1. 아키텍쳐
![javascript-christmas-architecture](/docs/image/javascript-christmas-architecture.png)

```
(1) 사용자는 InputView를 통해 방문 날짜와 주문 정보를 입력합니다.
(2) App은 InputValidator를 통해 입력값을 검증합니다.
(3) InputValidator는 입력값을 검증하고 필요한 형태로 변환해 반환합니다.
(4) App은 반환된 방문 날짜와 주문 정보를 토대로 Bill 인스턴스를 생성합니다.
(5) App은 생성된 Bill 인스턴스를 OutputView에게 전달합니다.
(6) OutputView는 Bill 클래스에게 이벤트 혜택 정보에 대한 계산을 요청합니다.
(7) Bill 클래스는 이벤트 혜택 정보를 계산하고 반환합니다.
(8) OutputView는 이벤트 혜택 정보를 outputHelper에게 전달합니다.
(9) outputHelper는 각 이벤트 혜택 정보를 출력값 형식에 맞게 수정해 반환합니다.
(10) OutputView는 반환된 값을 그대로 출력합니다.
```

## 2. 상세 설명
### 2-1. 들어가기 앞서
이번 미션을 진행하며 다음과 같은 내용을 고민하고 이를 반영하고자 노력했습니다.
- 비즈니스 로직과 UI를 담당하는 로직을 분리한다.
- 객체는 객체스럽게 사용한다. 즉, 데이터를 가진 객체가 데이터를 활용해 일하도록 한다.
- 발생할 수 있는 예외 상황에 대해 고민한다.
- 핵심 로직은 외부에서의 접근을 방지한다.
- 상수화를 최대한 진행한다.
- 배지의 경우 추후 프로젝트에서 활용할 수 있도록 구현한다.
- 도메인 로직에 단위 테스트를 구현한다. (해당 내용은 [테스트 코드](/docs/테스트_코드.md)에서 확인할 수 있습니다.)

또한, 실생활을 객체로 바라보는 객체지향 프로그래밍 관점에서 로직을 구현했습니다.
실생활에서 음식점에서 음식을 주문하는 과정을 생각하면 다음과 같습니다.
- 날짜와 주문 메뉴를 입력한다.
- 컴퓨터는 날짜와 주문 메뉴를 바탕으로 이벤트 정보를 계산한다.
- 계산된 결과값을 화면에 보여준다.

위 역할을 각 객체가 수행하도록 구현했습니다. 각 객체의 상세 내용에 대해서는 [기능 명세](#기능-명세)를 참고해주세요.

### 2-2. 파일 구조
<details>
<summary>펼치기</summary>
<div>

```
📦javascript-christmas-6-gouz7514
 ┣ 📂__tests__
 ┃ ┣ 📂class
 ┃ ┃ ┣ 📜BadgeTest.js
 ┃ ┃ ┣ 📜BillTest.js
 ┃ ┃ ┗ 📜MenuTest.js
 ┃ ┣ 📂util
 ┃ ┃ ┣ 📜DateTest.js
 ┃ ┃ ┣ 📜OrderTest.js
 ┃ ┃ ┗ 📜OutputHelperTest.js
 ┃ ┣ 📂validator
 ┃ ┃ ┗ 📜InputValidatorTest.js
 ┃ ┣ 📜ApplicationTest.js
 ┃ ┗ 📜OutputViewTest.js
 ┣ 📂docs
 ┃ ┗ 📜README.md
 ┣ 📂src
 ┃ ┣ 📂class
 ┃ ┃ ┣ 📜Badge.js
 ┃ ┃ ┣ 📜Bill.js
 ┃ ┃ ┗ 📜Menu.js
 ┃ ┣ 📂constants
 ┃ ┃ ┣ 📜badge.js
 ┃ ┃ ┣ 📜constant.js
 ┃ ┃ ┣ 📜error.js
 ┃ ┃ ┣ 📜menu.js
 ┃ ┃ ┗ 📜message.js
 ┃ ┣ 📂util
 ┃ ┃ ┣ 📜date.js
 ┃ ┃ ┣ 📜order.js
 ┃ ┃ ┗ 📜outputHelper.js
 ┃ ┣ 📂validator
 ┃ ┃ ┗ 📜InputValidator.js
 ┃ ┣ 📜App.js
 ┃ ┣ 📜InputView.js
 ┃ ┣ 📜OutputView.js
 ┃ ┗ 📜index.js
```

</div>
</details>

### 2-3. 기능 명세
#### `App` 
- 애플리케이션의 시작지점
- `InputView` 에게 명령을 내려 사용자의 입력을 받습니다.
- 사용자의 입력(방문 날짜, 주문 정보)을 토대로 `Bill` 을 생성합니다.
- 생성된 `Bill` 인스턴스를 `OutputView` 에 전달합니다.
- `run` 을 제외한 메소드를 private method로 선언해 외부에서의 접근을 방지합니다.

#### `InputView`
- 사용자의 입력을 받습니다.
- 입력을 받는 목적만 수행할 수 있게 입력값을 변환하지 않고 그대로 반환합니다.

#### `InputValidator`
- 사용자의 입력값을 요구 사항에 따라 예외 조건에 해당하는지 검증합니다.
- 하나의 검증 과정만을 수행하는 검증 메소드를 포함하고 있으며 이 메소드들은 각각 구현할 기능 `1-1-x` 와 `1-2-x` 를 담당합니다. (주석으로 표기)
- 각각의 검증 로직이 모여 **방문 날짜에 대한 검증**(`validateVisitDate`)과 **주문 정보에 대한 검증**(`validateOrders`)을 수행합니다.
- 방문 날짜와 주문 정보에 대한 검증이 끝나면 각각 필요한 형태로 변환해 반환합니다.
  - 방문 날짜 : `Number` 타입으로 변환해 반환
  - 주문 정보 : 문자열로 된 주문 정보를 `util/order.js` 를 활용해 아래와 같은 형태로 변환해 반환
    ```javascript
    // AS_IS
    const orders = "티본스테이크-1,바비큐립-1,초코케이크-2,제로콜라-1"
    
    // TO_BE
    const result = [
      { menu: '티본스테이크', amount: 1 },
      { menu: '바비큐립', amount: 1 },
      { menu: '초코케이크', amount: 2 },
      { menu: '제로콜라', amount: 1 }
    ]
    ```

#### `Bill`
- 방문 날짜, 주문 정보를 저장하고 이를 토대로 필요한 정보를 계산하는 클래스
- 실제로 음식점에서 주문을 하는 과정을 생각했을 때 컴퓨터, 또는 포스기의 역할을 수행하는 객체
- `App` 으로부터 `visitDate` (방문 날짜), `orders`(주문 정보)를 넘겨받아 private field인 `#result` 에 저장합니다.
- 애플리케이션의 **핵심 로직**인 ‘12월 이벤트 플래너’에서 필요한 정보(총주문 금액, 증정 메뉴 여부, 혜택 내역, 총혜택 금액, 할인 후 예상 결제 금액, 12월 이벤트 배지 여부)를 계산하는 메소드를 포함합니다. 이 메소드들은 각각 구현할 기능 `2` 의 상세 기능들을 담당합니다. (주석으로 표기)
  - 여러 계산 로직을 포함하는 메소드의 경우 각각의 로직을 하나의 메소드로 구현합니다.<br />
  >혜택 내역(`2-3`) = 크리스마스 디데이 할인(`2-3-1`) + 평일 or 주말 할인(`2-3-2`) + 특별 할인(`2-3-3`) + 증정 이벤트(`2-3-4`)
- public method인 `calculateBill` 메소드를 통해 필요한 모든 정보를 계산합니다.
- `calculateBill` 메소드를 제외한 모든 메소드는 private method로 구현합니다.
    - 애플리케이션의 **핵심 로직을 구현하는 코드의 외부 접근을 방지해 내부 로직 및 결과값의 오염을 방지**합니다.
- `createBadge` 메소드는 총혜택 금액에 따라 이벤트 배지를 부여합니다.
    - 배지는 2024 새해 이벤트에서 활용할 예정이므로 꼭 필요한 경우에만 배지 인스턴스를 생성해야 합니다.
    - 이벤트 대상이 아니거나, 총혜택 금액이 배지를 부여하기 위한 최소 금액(5,000원) 미만인 경우 배지 인스턴스 자체를 생성하지 않도록 합니다.

#### `Menu`
- 메뉴 역할을 수행하는 클래스
> ❓ **메뉴를 별도의 클래스로 구현한 이유?**<br />
> 💡 **상수가 아닌 클래스로 구현함으로써 실제 데이터베이스의 메뉴와 연동하는 것처럼 동작할 수 있습니다.**<br />
> 해당 프로젝트에서는 메뉴를 상수화하고 이를 `Menu` 클래스에서 호출하는 방식이지만, 호출 경로가 상수 파일이 아닌 실제 DB라면 새로운 메뉴를 추가하기도 쉽고, 메뉴 관련 동작을 하나의 클래스에서 관리하게 됨으로써 코드의 유지보수성을 높일 수 있게 됩니다.

- 메뉴에 관련된 상수를 포함합니다. (메뉴 타입, 메뉴 수량, 실제 메뉴, 증정 이벤트 메뉴)
- 메뉴 정보와 관련된 로직을 수행합니다.
  - 메뉴명에 대해 메뉴판에 있는 메뉴인지, 메뉴의 타입, 가격을 확인하고 결과를 반환합니다.
  - 주문 수량이 최소 주문 수량(1), 최대 주문 수량(20) 조건을 만족하는지 확인하고 결과를 반환합니다.
  - 주문한 메뉴가 음료만으로 구성되어 있는지 확인하고 결과를 반환합니다.
- 메뉴 객체는 애플리케이션의 전체 흐름에 걸쳐 하나만 필요하므로 싱글톤 패턴을 적용해 하나의 메뉴만을 애플리케이션 흐름 전체에 걸쳐 사용할 수 있게 합니다. ([참고 링크](https://bugoverdose.github.io/development/singleton-and-react-state-management/))

#### `Badge`
- 혜택 금액에 따라 이벤트 배지의 정보를 생성하는 클래스
- 배지 정보를 반환하는 `getInfo` 메소드를 제외한 메소드를 private method로 구현해 배지 정보의 변경을 방지합니다.
- 2024 새해 이벤트에서 활용할 수 있게 배지 관련 로직은 모두 해당 클래스 내에서만 수행합니다. (해당 파일을 그대로 옮겨도 정상 동작을 수행할 수 있게 구현합니다)

#### `OutputView`
- 정보성, 결과 메시지 또는 에러 메시지를 출력합니다.
- 필요한 정보를 `outputHelper` 에게 넘기고 반환된 값을 그대로 출력합니다.
- 파라미터에 대한 변환을 수행하지 않고 오직 출력 역할만 담당합니다.

#### `outputHelper`
- `OutputView` 로부터 넘겨받은 파라미터를 출력값 형식에 맞게 수정해 반환합니다.
- 조건에 따라 필요한 상수를 활용해 결과를 반환합니다.

## 3. 구현할 기능 목록
- [x] 1. 고객의 입력을 받는다.
  - [x] 1-1. 고객의 식당 예상 방문 날짜를 입력받는다.
    - [x] 1-1-1. 입력값은 숫자여야 한다.
    - [x] 1-1-2. 입력값은 1 이상 31 이하의 숫자여야만 한다.
  - [x] 1-2. 고객의 메뉴를 입력받는다.
    - [x] 1-2-1. 메뉴 형식은 예시와 같아야 한다.
    - [x] 1-2-2. 메뉴판에 있는 메뉴여야만 한다.
    - [x] 1-2-3. 메뉴의 개수는 1 이상의 숫자여야만 한다.
    - [x] 1-2-4. 중복 메뉴는 허용하지 않는다.
    - [x] 1-2-5. 총 메뉴의 개수는 20개를 초과할 수 없다.
    - [x] 1-2-6. 음료만 주문 시, 주문할 수 없다.
- [x] 2. 방문 날짜와 주문 메뉴를 토대로 영수증을 생성한다.
  - [x] 2-1. 할인 전 총주문 금액을 계산한다.
    - [x] 2-1-1. 총주문 금액 10,000원 이상부터 이벤트를 적용한다. 아닌 경우 바로 `2-6`을 실행한다.
  - [x] 2-2. 총주문 금액이 12만 원 이상이면 증정 이벤트를 진행한다.
  - [x] 2-3. 혜택 내역을 계산한다.
    - [x] 2-3-1. 크리스마스 디데이 할인 금액를 계산한다. 디데이 할인만 23.12.01 ~ 23.12.25 동안 반영된다.
    - [x] 2-3-2. 요일에 따라 평일, 주말 할인 금액을 계산한다.
    - [x] 2-3-3. 특별 할인 금액을 계산한다.
    - [x] 2-3-4. 증정 이벤트 금액을 계산한다. 증정 이벤트 진행(`2-2`) 시 샴페인 1개를 증정한다.
  - [x] 2-4. 총혜택 금액(`2-4-1` + `2-4-2`)을 계산한다.
    - [x] 2-4-1. 할인 금액의 합계(`2-3-1` + `2-3-2`)를 계산한다.
    - [x] 2-4-2. 증정 이벤트 여부에 따라 증정 메뉴의 가격을 계산한다.
  - [x] 2-5. 총혜택 금액(`2-4`)에 따라 12월 이벤트 배지를 부여한다. 이 배지는 새해 이벤트에서 활용한다.
  - [x] 2-6. 할인 후 예상 결제 금액(`2-1` - `2-4-1`)을 계산한다.
- [x] 3. 최종 정보를 출력한다.
  - [x] 3-1. 주문 메뉴를 출력한다.
  - [x] 3-2. 할인 전 총주문 금액을 출력한다.
  - [x] 3-3. 증정 메뉴를 출력한다. 증정 이벤트에 해당하지 않는 경우, 증정 메뉴 `없음` 으로 출력한다.
  - [x] 3-4. 혜택 내역을 출력한다. 고객에게 적용된 이벤트 내역만 보여준다. 없을 경우 `없음` 으로 출력한다.
  - [x] 3-5. 총혜택 금액을 출력한다. 0원인 경우 `0원` 을 출력한다.
  - [x] 3-6. 할인 후 예상 결제 금액을 계산한다.
  - [x] 3-7. 12월 이벤트 배지를 출력한다. 없을 경우 `없음` 으로 출력한다.